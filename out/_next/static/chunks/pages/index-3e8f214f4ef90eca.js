(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{8312:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return s(2399)}])},1862:function(){},1226:function(e){e.exports={App:"App_App__Ok5yT","with-process-list":"App_with-process-list__KUGov","without-process-list":"App_without-process-list___sr7R",ProcessesList:"App_ProcessesList__tpSJz",ProcessTerminal:"App_ProcessTerminal__D_AVR",BottomToolbar:"App_BottomToolbar__KORTV"}},1136:function(e){e.exports={BottomToolbarButton:"BottomToolbarButton_BottomToolbarButton__JKPC2",right:"BottomToolbarButton_right__HA3xt",left:"BottomToolbarButton_left__sVxrR",down:"BottomToolbarButton_down__GjHLh"}},7940:function(e){e.exports={BottomToolbar:"BottomToolbar_BottomToolbar__p0A0l",floatLeft:"BottomToolbar_floatLeft___8G_f",floatRight:"BottomToolbar_floatRight__KfRzG"}},5515:function(e){e.exports={ProcessTerminalInput:"ProcessTerminalInput_ProcessTerminalInput__YLv7R"}},9573:function(e){e.exports={ProcessTerminal:"ProcessTerminal_ProcessTerminal__G0_X4",output:"ProcessTerminal_output__1ZzZW",inner:"ProcessTerminal_inner__t8Eph",input:"ProcessTerminal_input__YHXhs"}},78:function(e){e.exports={ProcessesList:"ProcessesList_ProcessesList__imImB"}},7404:function(e){e.exports={StartModal:"StartModal_StartModal__XTJ0W"}},5374:function(e){e.exports={App:"index_App__Rk55V"}},2399:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return V}});var r,o,n=s(1844);s(1862);var i=s(2946),l=s(8594),a=s(8114);class c{async recieveInput(e){this.socketClient.emit("recieveInput",{processId:this.processId,input:e})}constructor(e,t,s,r){this.socketClient=e,this.processId=t,this.processTitle=s,this.menuItem=r,this.logs=new i.X([]),this.inputForm=new i.X((0,a.ZP)("")),this.socketClient.emit("subscribeToLogsAndInputFrom",{processId:t}),this.socketClient.on("newLog",e=>{let{logs:t}=e;this.logs.next(Array.from(new Set([...this.logs.value,...t])))}),this.socketClient.on("inputForm",e=>{let{inputForm:t}=e;this.inputForm.next(t)})}}class u{async getProcessById(e){return this.processesConnectorsCache.has(e)?await this.processesConnectorsCache.get(e):(console.log("getProcessById",e),this.socketClient.emit("getProcessById",{processId:e}),new Promise(t=>{this.socketClient.once("getProcessById",s=>{let{processTitle:r,menuItem:o}=s,n=new c(this.socketClient,e,r,o);this.processesConnectorsCache.set(e,n),t(n)})}))}async getNewProcessOptionsForm(){return await this.newProcessOptionsForm}async startNewProcess(e){return this.socketClient.emit("startNewProcess",e),new Promise((e,t)=>{this.socketClient.once("newProcess",s=>{"processId"in s?e(s.processId):"errorMessage"in s?t(Error(s.errorMessage)):t(Error("Unknown error"))})})}constructor(e){this.apiUrl=e,this.processes=new i.X([]),this.processesConnectorsCache=new Map,this.socketClient=l.Z.io(this.apiUrl.href,{transports:["websocket","polling"]}),this.newProcessOptionsForm=new Promise(e=>{this.socketClient.on("newProcessOptionsForm",t=>{e((0,a.ZP)(t))})}),this.socketClient.on("processes",e=>{this.processes.next(e)})}}function m(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return t.filter(e=>e).join(" ")}var p=s(5784);function h(e){let t;t=e instanceof i.X?{status:o.Ongoing,value:e.value,error:null,isComplete:!1}:{status:o.Pending,value:void 0,error:void 0,isComplete:!1};let[s,r]=p.useState(t);return p.useEffect(()=>{let t=e.subscribe({next(e){r({status:o.Ongoing,value:e,error:null,isComplete:!1})},complete(){r({status:o.Complete,value:s.value,error:null,isComplete:!0})},error(e){r({status:o.Error,value:null,error:e,isComplete:!0})}});return()=>{t.unsubscribe()}},[e]),s}function d(e,t){let[s,r]=p.useState({status:o.Pending,value:void 0,error:void 0,isComplete:!1});return p.useEffect(()=>((async()=>{try{let t=await e;r({status:o.Complete,value:t,error:null,isComplete:!0})}catch(e){e instanceof Error?r({status:o.Error,value:null,error:e,isComplete:!0}):console.error("Called usePromise with reject which not rejected Error ",{thrown:e})}})(),()=>{}),t||[e]),s}(r=o||(o={})).Pending="PENDING",r.Ongoing="ONGOING",r.Error="ERROR",r.Complete="COMPLETE";let _=new URL("http://localhost:5001/");function f(e){let[t,s]=(0,p.useState)(e);return[t,()=>void s(!t)]}var A=s(5675),w=s.n(A),g={src:"/_next/static/media/arrow-up-closed.b9de58e3.png",height:19,width:18,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAA0klEQVR42g2OPw/BQByGf7OPYhImCxYTsZnP5qOIb9CQnEEbjUiwEEEYVDpe2kgq1T/XnrbXSkdDF259nzd5HvB93/M8zvl6s9muVizP39drUS6DAEmSLFS1Xa9XB4PTZPJDKNnvIYoijHGjUrHE5XB4ABxHIz9NQVGUfqdjUWrudt9SKT6fm8PhYj4Hk5BnENxV9QMw7vWmyyWjlBACLueX2SwDyDTNsO1uqyVJkrCCjnEsVl1/xXEUho7jIIRkWYaiVuO3m8M5dV3RzRgTzDCMP2ltgumKMkP5AAAAAElFTkSuQmCC",blurWidth:8,blurHeight:8},v={src:"/_next/static/media/arrow-up.af4c72b4.png",height:19,width:18,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAAAAADhZOFXAAAAT0lEQVR42gUAKQ7AIKxv2vwUkjds30Kh2CHhJwRLaJtCSPnFAkwrxkUMrN9xvMow/Ya4+wmPlZTE3pAlGBMkgzpTq3EK4cTe8QpQ2iAarfxMKi0bSTjRGAAAAABJRU5ErkJggg==",blurWidth:8,blurHeight:8},P=s(1136),x=s.n(P);function C(e){let{direction:t,isClosed:s,onClick:r}=e;return(0,n.jsx)("div",{className:m(x().BottomToolbarButton,x()[t.toLowerCase()]),onClick:()=>{r()},children:(0,n.jsx)(w(),{alt:"arrow",src:s?g:v})})}var T=s(7940),j=s.n(T);function E(e){let{isProcessesVisible:t,toggleProcessesVisible:s,isTerminalPinned:r,toggleTerminalPinned:o}=e;return(0,n.jsxs)("div",{className:j().BottomToolbar,children:[(0,n.jsx)("div",{className:j().floatLeft,children:(0,n.jsx)(C,{direction:t?"LEFT":"RIGHT",onClick:s})}),(0,n.jsx)("div",{className:j().floatRight,children:(0,n.jsx)(C,{direction:"DOWN",isClosed:r,onClick:o})})]})}var b=s(78),N=s.n(b);function B(e){let{serverConnector:t}=e,{value:s}=h(t.processes);return(0,n.jsxs)("div",{className:N().ProcessesList,children:[(0,n.jsx)("h2",{children:"Seznam procesÅ¯: "}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsx)("a",{href:"",target:"_blank",children:(0,n.jsx)("span",{className:"name",children:"New process"})})}),(s||[]).map(e=>(0,n.jsx)("li",{dangerouslySetInnerHTML:{__html:e.menuItem}},e.processId))]})]})}var I=s(5515),k=s.n(I);function S(e){let{serverProcess:t}=e,{value:s}=h(t.inputForm);return s?(0,n.jsx)("div",{className:k().ProcessTerminalInput,dangerouslySetInnerHTML:{__html:s},ref:e=>{if(e)for(let s of(console.log("ref"),Array.from(e.querySelectorAll("form"))))"1"!==s.dataset.iportActive&&(s.dataset.iportActive="1",s.addEventListener("submit",async e=>{e.preventDefault();let r=new FormData(s),o=Object.fromEntries(r);try{await t.recieveInput(o),s.reset()}catch(e){if(!(e instanceof Error))throw e;console.error(e),alert(e.message)}}))}}):(0,n.jsx)(n.Fragment,{})}var y=s(9573),O=s.n(y);function L(e){let{serverProcess:t,isTerminalPinned:s}=e,{value:r}=h(t.logs);return r&&0!==r.length||(r=[(0,a.ZP)("<li><i>No logs yet</i></li>")]),(0,n.jsxs)("div",{className:O().ProcessTerminal,children:[(0,n.jsx)("div",{className:O().output,children:(0,n.jsx)("div",{className:O().inner,ref:e=>{e&&!s&&e.scrollBy(0,1e4)},children:(0,n.jsx)("ul",{children:r.map((e,t)=>(0,n.jsx)("li",{dangerouslySetInnerHTML:{__html:e}},t))})})}),(0,n.jsx)("div",{className:O().input,children:(0,n.jsx)("div",{className:O().inner,children:(0,n.jsx)(S,{serverProcess:t})})})]})}var R=s(7404),M=s.n(R);function U(e){let{serverConnector:t}=e,{value:s}=d(t.getNewProcessOptionsForm(),[t]);return(0,n.jsx)("div",{className:M().StartModal,dangerouslySetInnerHTML:{__html:s||""},ref:e=>{if(e)for(let s of Array.from(e.querySelectorAll("form")))"1"!==s.dataset.iportActive&&(s.dataset.iportActive="1",s.addEventListener("submit",async e=>{e.preventDefault();let r=new FormData(s),o=Object.fromEntries(r);try{let e=await t.startNewProcess(o),r=new URL(window.location.href);r.hash="#"+e.toString(),window.open(r,e.toString()),s.reset()}catch(e){if(!(e instanceof Error))throw e;console.error(e),alert(e.message)}}))}})}var F=s(1226),D=s.n(F);function X(e){let[t,s]=f(!0),[r,o]=f(!1),i=function(){let e=window.location.hash;return""===e||"#"===e?null:e.substring(1)}(),l=(0,p.useMemo)(()=>new u(_),[]),{value:a}=d(null===i?Promise.resolve("NO_PROCESS"):l.getProcessById(i),[i]);return((0,p.useEffect)(()=>{a&&"NO_PROCESS"!==a&&(window.document.title=a.processTitle)}),a)?(0,n.jsxs)("main",{className:m(D().App,D()[t?"with-process-list":"without-process-list"]),children:[t&&(0,n.jsx)("nav",{className:D().ProcessesList,children:(0,n.jsx)(B,{serverConnector:l})}),(0,n.jsx)("main",{className:D().ProcessTerminal,children:"NO_PROCESS"===a?(0,n.jsx)(U,{serverConnector:l}):(0,n.jsx)(L,{serverProcess:a,isTerminalPinned:r})}),(0,n.jsx)("footer",{className:D().BottomToolbar,children:(0,n.jsx)(E,{isProcessesVisible:t,toggleProcessesVisible:s,isTerminalPinned:r,toggleTerminalPinned:o})})]}):(0,n.jsx)(n.Fragment,{children:"Connecting"})}var G=s(5374),H=s.n(G);function V(){return(0,n.jsx)("div",{className:H().App,children:(0,n.jsx)(X,{})})}}},function(e){e.O(0,[725,888,179],function(){return e(e.s=8312)}),_N_E=e.O()}]);